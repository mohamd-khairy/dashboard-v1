import{bP as W,aB as ee,k as b,o as y,b as D,w as l,p as t,bQ as Y,bR as te,bS as G,ak as L,m as _,y as g,q as e,b$ as K,c0 as le,av as ae,aw as M,al as $,ap as F,bD as T,C as pe,A as X,c6 as Ce,c as P,F as oe,a as se,I as ce,b0 as Ve,an as R,ar as Z,bZ as ke,as as Se}from"./index.8d01543a.js";import{_ as ne}from"./DialogCloseBtn.0d2acdf8.js";import{u as H}from"./Cities.0d3fd555.js";import{V as ie}from"./VForm.6ad382fa.js";import{V as re}from"./VDialog.6b48d5ed.js";import{O as fe,x as _e,S as ge,_ as ve}from"./index.es.c5145049.js";import{u as ye}from"./Countries.9c35560c.js";import{d as Q}from"./VTextField.b27bb6f2.js";import{V as ue}from"./VSelect.2c43c85a.js";import{V as be}from"./VSwitch.5107874e.js";import{r as J}from"./validators.dc210ddc.js";import"./moment.9709ab41.js";import{V as we}from"./VSpacer.40a311d3.js";import{V as me}from"./VDivider.c9b30b9a.js";import{V as xe}from"./VPagination.6b05bef2.js";import"./forwardRefs.74a345f5.js";import"./VOverlay.cd1f8bc0.js";import"./lazy.746ef82b.js";import"./index.4049f65e.js";import"./VList.35d78c12.js";import"./ssrBoot.e590dc30.js";import"./VMenu.535e4389.js";import"./VCheckboxBtn.6481c716.js";import"./VChip.2389378e.js";const Ae={__name:"DeleteCityDialog",props:{isDeleteOpen:{type:Boolean,required:!0},city:{type:Object,required:!0}},emits:["update:isDeleteOpen","refreshTable"],setup(E,{emit:x}){const S=E,w=x,{t:i}=W(),h=H(),C=ee(),s=b(!1),V=()=>{w("update:isDeleteOpen",!1)},k=()=>{s.value=!0,h.deleteCity(S.city).then(()=>{C.alertColor="success",C.alertMessage="\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0645\u062F\u064A\u0646\u0629 \u0628\u0646\u062C\u0627\u062D",w("refreshTable"),w("update:isDeleteOpen",!1),C.isAlertShow=!0,setTimeout(()=>{C.isAlertShow=!1,C.alertMessage="",s.value=!1},1e3)}).catch(p=>{s.value=!1,C.alertColor="error",C.alertMessage="\u062D\u062F\u062B \u062E\u0637\u0623 \u0645\u0627 !",C.isAlertShow=!0,setTimeout(()=>{C.isAlertShow=!1,C.alertMessage=""},2e3)})},r=p=>{w("update:isDeleteOpen",p)};return(p,m)=>{const O=ne;return y(),D(re,{width:p.$vuetify.display.smAndDown?"auto":650,"model-value":S.isDeleteOpen,"onUpdate:modelValue":r},{default:l(()=>[t(O,{onClick:m[0]||(m[0]=u=>r(!1))}),t(Y,{class:"pa-sm-9 pa-5"},{default:l(()=>[t(te,null,{default:l(()=>[t(G,{class:"text-h5 text-center mb-3"},{default:l(()=>[t(L,{icon:"ph:info-light",color:"#f00",size:"50"}),_("h5",null,g(e(i)("ask_delete")),1)]),_:1})]),_:1}),t(K,null,{default:l(()=>[t(ie,{ref:"refForm",onSubmit:le(k,["prevent"])},{default:l(()=>[t(ae,null,{default:l(()=>[t(M,{cols:"12",class:"text-center"},{default:l(()=>[e(s)?(y(),D($,{key:1,type:"submit",class:"position-relative me-3"},{default:l(()=>[t(L,{icon:"mingcute:loading-line",class:"loading",size:"32"})]),_:1})):(y(),D($,{key:0,type:"submit",class:"me-3"},{default:l(()=>[F(g(e(i)("buttons.confirm")),1)]),_:1})),t($,{variant:"tonal",color:"secondary",onClick:V},{default:l(()=>[F(g(e(i)("buttons.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}},Oe={class:"mx-1 my-1"},De={__name:"EditCityDialog",props:{isEditOpen:{type:Boolean,required:!0},city:{type:Object,required:!0}},emits:["refreshTable","update:isEditOpen"],setup(E,{emit:x}){const S=E,w=x,{t:i}=W(),h=H(),C=ye(),s=ee(),V=T([]),k=b(!1);pe(()=>{m.slice(0,m.length-1),A.slice(0,A.length-1),C.fetchCountries({}).then(o=>{V.value=o.data.data})});const r=T({id:null,name_ar:null,name_en:null,country_id:null,is_available_for_delivery:null,polygon:""});X(()=>m);const p=T({lat:null,lng:null}),m=T([]),O=b({path:m,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2});Ce(()=>{m.slice(0,m.length-1),A.slice(0,A.length-1),m.length=0,A.length=0,r.id=S.city.id,r.name_ar=S.city.name_ar,r.name_en=S.city.name_en,r.country_id=S.city.country,r.is_available_for_delivery=S.city.is_available_for_delivery,r.polygon=S.city.polygon,S.city.polygon&&S.city.polygon.map((o,a)=>{let n=o.toString().split(" ")[0],d=o.toString().split(" ")[1];a===0&&(p.lat=n,p.lng=d);let f={lat:Number(n),lng:Number(d)},I={label:"Marker"};A.push({position:f,...I}),m.push(f)})});const u=()=>{w("update:isEditOpen",!1)},U=b(null),A=T([]),z=async()=>{k.value=!0;let o={id:r.id,name_ar:r.name_ar,name_en:r.name_en,country_id:r.country_id.id,is_available_for_delivery:r.is_available_for_delivery,polygon:[]};m.map((n,d)=>{o.polygon.push([n.lat,n.lng])}),(await U.value.validate()).valid?h.editCity(o).then(n=>{w("update:isEditOpen",!1),w("refreshTable"),s.alertColor="success",s.alertMessage="\u062A\u0645 \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0645\u062F\u064A\u0646\u0629 \u0628\u0646\u062C\u0627\u062D",s.isAlertShow=!0,setTimeout(()=>{s.isAlertShow=!1,s.alertMessage="",k.value=!1},1e3)}).catch(n=>{n.response.data.errors?Object.keys(n.response.data.errors).forEach(f=>{s.alertMessage=i(`errors.${f}`)}):s.alertMessage="\u062D\u062F\u062B \u062E\u0637\u0623 \u0645\u0627 !",k.value=!1,s.alertColor="error",s.isAlertShow=!0,setTimeout(()=>{s.isAlertShow=!1,s.alertMessage=""},2e3)}):(k.value=!1,s.alertMessage="\u064A\u0631\u062C\u064A \u062A\u0639\u0628\u0626\u0629 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629 !",s.alertColor="error",s.isAlertShow=!0,setTimeout(()=>{s.isAlertShow=!1,s.alertMessage=""},2e3))},B=o=>{w("update:isEditOpen",o)},q=o=>{A.length=0,location.lat=o.lat,location.lng=o.lng,p.lat=o.lat,p.lng=o.lng},N=o=>{if(o.latLng){const a={lat:o.latLng.lat(),lng:o.latLng.lng()},n={label:"Marker"};A.push({position:a,...n}),m.push(a)}},c=o=>{const a=A.findIndex(n=>n.position.lat===o.position.lat&&n.position.lng==o.position.lng);A.splice(a,1),m.splice(a,1)};return(o,a)=>{const n=ne,d=ve;return y(),D(re,{width:o.$vuetify.display.smAndDown?"auto":650,"model-value":S.isEditOpen,"onUpdate:modelValue":B},{default:l(()=>[t(n,{onClick:a[0]||(a[0]=f=>B(!1))}),t(Y,{class:"pa-sm-9 pa-5"},{default:l(()=>[t(te,null,{default:l(()=>[t(G,{class:"text-h5 d-flex flex-column align-center gap-2 text-center mb-3"},{default:l(()=>[t(L,{icon:"solar:city-broken",size:"24",color:"primary"}),_("span",Oe,g(e(i)("Edit_City")),1)]),_:1})]),_:1}),t(K,null,{default:l(()=>[t(ie,{ref_key:"refForm",ref:U,onSubmit:le(z,["prevent"])},{default:l(()=>[t(ae,null,{default:l(()=>[t(M,{cols:"12",lg:"12",sm:"6"},{default:l(()=>[t(Q,{modelValue:e(r).name_en,"onUpdate:modelValue":a[1]||(a[1]=f=>e(r).name_en=f),label:e(i)("forms.name_en")},null,8,["modelValue","label"])]),_:1}),t(M,{cols:"12",lg:"12",sm:"6"},{default:l(()=>[t(Q,{modelValue:e(r).name_ar,"onUpdate:modelValue":a[2]||(a[2]=f=>e(r).name_ar=f),label:e(i)("forms.name_ar")},null,8,["modelValue","label"])]),_:1}),t(M,{cols:"12",lg:"12",sm:"6"},{default:l(()=>[t(ue,{modelValue:e(r).country_id,"onUpdate:modelValue":a[3]||(a[3]=f=>e(r).country_id=f),items:e(V).value,label:e(i)("forms.countries"),"item-title":"name_ar","item-value":"id"},null,8,["modelValue","items","label"])]),_:1}),t(M,{cols:"12",lg:"12",sm:"6"},{default:l(()=>[t(be,{label:e(i)("available_for_delivery"),modelValue:e(r).is_available_for_delivery,"onUpdate:modelValue":a[4]||(a[4]=f=>e(r).is_available_for_delivery=f)},null,8,["label","modelValue"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(d,{onSelectLocation:q}),t(e(fe),{"api-key":"AIzaSyCM2TngqydZtVlZ5hkKjY7x56ut59TTI88",style:{width:"100%",height:"500px"},center:{lat:Number(e(p).lat),lng:Number(e(p).lng)},zoom:10,onClick:N},{default:l(()=>[(y(!0),P(oe,null,se(e(A),(f,I)=>(y(),D(e(_e),{key:I,options:f,onClick:j=>c(f)},null,8,["options","onClick"]))),128)),t(e(ge),{options:e(O)},null,8,["options"])]),_:1},8,["center"])]),_:1}),t(M,{cols:"12",class:"text-center"},{default:l(()=>[e(k)?(y(),D($,{key:1,type:"submit",class:"position-relative me-3"},{default:l(()=>[t(L,{icon:"mingcute:loading-line",class:"loading",size:"32"})]),_:1})):(y(),D($,{key:0,type:"submit",class:"me-3"},{default:l(()=>[F(g(e(i)("buttons.save")),1)]),_:1})),t($,{variant:"tonal",color:"secondary",onClick:u},{default:l(()=>[F(g(e(i)("buttons.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}},Me={class:"mx-1 my-1"},Te={__name:"AddCityDialog",props:{isAddOpen:{type:Boolean,required:!0}},emits:["refreshTable","update:isAddOpen"],setup(E,{emit:x}){const S=E,w=x,{t:i}=W(),h=H(),C=ye(),s=ee(),V=T([]),k=b(!1),r=b(null),p=T({lat:null,lng:null});pe(()=>{navigator.geolocation.getCurrentPosition(c=>{p.lat=c.coords.latitude,p.lng=c.coords.longitude}),C.fetchCountries().then(c=>{V.value=c.data.data})}),T([]);const m=T([]);T({lat:30.0564503,lng:-74.1840919});const O=T([]),u=T({name_ar:null,name_en:null,country_id:null,is_available_for_delivery:0,polygon:[]}),U=()=>{u.name_ar=null,u.name_en=null,u.country_id=null,u.is_available_for_delivery=!1,u.polygon=[],w("update:isAddOpen",!1)},A=async()=>{if(k.value=!0,(await r.value.validate()).valid){let o={name_ar:u.name_ar,name_en:u.name_en,country_id:u.country_id,is_available_for_delivery:u.is_available_for_delivery,polygon:[]};m.map((a,n)=>{o.polygon.push([a.lat,a.lng])}),console.log(o.polygon),h.storeCity(o).then(a=>{w("update:isAddOpen",!1),w("refreshTable"),U(),s.alertColor="success",s.alertMessage="\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u062F\u064A\u0646\u0629 \u0628\u0646\u062C\u0627\u062D",s.isAlertShow=!0,setTimeout(()=>{s.isAlertShow=!1,s.alertMessage=""},2e3),U()}).catch(a=>{a.response.data.errors?Object.keys(a.response.data.errors).forEach(d=>{s.alertMessage=i(`errors.${d}`)}):s.alertMessage="\u062D\u062F\u062B \u062E\u0637\u0623 \u0645\u0627 !",k.value=!1,s.alertColor="error",s.isAlertShow=!0,setTimeout(()=>{s.isAlertShow=!1,s.alertMessage=""},2e3)})}else k.value=!1,s.alertMessage="\u064A\u0631\u062C\u064A \u062A\u0639\u0628\u0626\u0629 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629 !",s.alertColor="error",s.isAlertShow=!0,setTimeout(()=>{s.isAlertShow=!1,s.alertMessage=""},2e3)},z=c=>{w("update:isAddOpen",c)},B=c=>{O.length=0,p.lat=c.lat,p.lng=c.lng,u.latitude=c.lat,u.longitude=c.lng},q=c=>{if(c.latLng){const o={lat:c.latLng.lat(),lng:c.latLng.lng()},a={label:"Marker"};O.push({position:o,...a}),m.push(o)}},N=c=>{const o=O.findIndex(a=>a.position.lat===c.position.lat&&a.position.lng==c.position.lng);O.splice(o,1),m.splice(o,1)};return(c,o)=>{const a=ne,n=ve;return y(),D(re,{width:c.$vuetify.display.smAndDown?"auto":650,"model-value":S.isAddOpen,"onUpdate:modelValue":z},{default:l(()=>[t(a,{onClick:o[0]||(o[0]=d=>z(!1))}),t(Y,{class:"pa-sm-9 pa-5"},{default:l(()=>[t(te,null,{default:l(()=>[t(G,{class:"text-h5 d-flex flex-column align-center gap-2 text-center mb-3"},{default:l(()=>[t(L,{icon:"solar:city-broken",size:"24",color:"primary"}),_("span",Me,g(e(i)("Add_City")),1)]),_:1})]),_:1}),t(K,null,{default:l(()=>[t(ie,{ref_key:"refForm",ref:r,onSubmit:le(A,["prevent"])},{default:l(()=>[t(ae,null,{default:l(()=>[t(M,{cols:"12",lg:"12",sm:"6"},{default:l(()=>[t(Q,{modelValue:e(u).name_en,"onUpdate:modelValue":o[1]||(o[1]=d=>e(u).name_en=d),label:e(i)("forms.name_en"),rules:[e(J)]},null,8,["modelValue","label","rules"])]),_:1}),t(M,{cols:"12",lg:"12",sm:"6"},{default:l(()=>[t(Q,{modelValue:e(u).name_ar,"onUpdate:modelValue":o[2]||(o[2]=d=>e(u).name_ar=d),label:e(i)("forms.name_ar"),rules:[e(J)]},null,8,["modelValue","label","rules"])]),_:1}),t(M,{cols:"12",lg:"12",sm:"6"},{default:l(()=>[t(ue,{modelValue:e(u).country_id,"onUpdate:modelValue":o[3]||(o[3]=d=>e(u).country_id=d),items:e(V).value,label:e(i)("forms.countries"),"item-title":"name_ar","item-value":"id",rules:[e(J)]},null,8,["modelValue","items","label","rules"])]),_:1}),t(M,{cols:"12",lg:"12",sm:"6"},{default:l(()=>[t(be,{label:e(i)("available_for_delivery"),modelValue:e(u).is_available_for_delivery,"onUpdate:modelValue":o[4]||(o[4]=d=>e(u).is_available_for_delivery=d)},null,8,["label","modelValue"])]),_:1}),t(M,{cols:"12"},{default:l(()=>[t(n,{onSelectLocation:B}),t(e(fe),{"api-key":"AIzaSyCM2TngqydZtVlZ5hkKjY7x56ut59TTI88",style:{width:"100%",height:"500px"},center:{lat:e(p).lat,lng:e(p).lng},zoom:12,onClick:q},{default:l(()=>[(y(!0),P(oe,null,se(e(O),(d,f)=>(y(),D(e(_e),{key:f,options:d,onClick:I=>N(d)},null,8,["options","onClick"]))),128)),t(e(ge),{options:{path:e(m),geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2}},null,8,["options"])]),_:1},8,["center"])]),_:1}),t(M,{cols:"12",class:"text-center"},{default:l(()=>[e(k)?(y(),D($,{key:1,type:"submit",class:"position-relative me-3"},{default:l(()=>[t(L,{icon:"mingcute:loading-line",class:"loading",size:"32"})]),_:1})):(y(),D($,{key:0,type:"submit",class:"me-3"},{default:l(()=>[F(g(e(i)("buttons.save")),1)]),_:1})),t($,{variant:"tonal",color:"secondary",onClick:U},{default:l(()=>[F(g(e(i)("buttons.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}},$e={class:"mx-1"},Le={style:{width:"5rem"}},Ue={scope:"col",class:"font-weight-semibold"},Fe={scope:"col",class:"font-weight-semibold"},Ee={scope:"col",class:"font-weight-semibold"},ze={scope:"col",class:"font-weight-semibold"},Be={scope:"col",class:"font-weight-semibold"},Ie=["onClick"],Pe=_("tr",null,[_("td",{colspan:"8",class:"text-center text-body-1"}," \u0644\u0627 \u064A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A ")],-1),qe=[Pe],Ne={class:"text-sm text-disabled"},pt={__name:"cities",setup(E){const{t:x}=W(),S=H(),w=b("");b();const i=b(5),h=b(1),C=b(1),s=b(0),V=b([]);b([]);const k=b(!1),r=b(!1),p=b({}),m=b(!1),O=b(!1),u=()=>{O.value=!0,S.fetchCities({q:w.value}).then(a=>{V.value=a.data.data,C.value=V.value/i,s.value=V.value.length,h.value=1,O.value=!1}).catch(a=>{O.value=!1,console.log(a)})};ce(()=>{u()}),ce(()=>{i.value&&(h.value=1)});const U=X(()=>(C.value=Math.ceil(V.value.length/i.value),V.value.filter((a,n)=>{let d=(h.value-1)*i.value,f=h.value*i.value;if(n>=d&&n<f)return!0}))),A=()=>{h.value*i.value<V.value.length&&h.value},z=()=>{h.value>1&&h.value},B=X(()=>{const a=V.value.length?(h.value-1)*i.value+1:0,n=a+(i.value-1)<=V.value.length?a+(i.value-1):s.value;return` \u0639\u0631\u0636 \u0645\u0646 ${o(a)} \u0625\u0644\u064A ${o(n)} \u0645\u0646 ${o(s.value)} \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A `}),q=a=>{},N=a=>{r.value=!0,p.value=a},c=a=>{m.value=!0,p.value=a},o=a=>{const n="\u0660\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669";return String(a).replace(/[0123456789]/g,d=>n[d])};return(a,n)=>{const d=Te,f=De,I=Ae,j=Ve("can");return y(),P("div",null,[t(Y,{loading:e(O)},{default:l(()=>[t(G,{class:"d-flex align-center"},{default:l(()=>[t(L,{icon:"solar:city-broken",size:"24",color:"primary"}),_("span",$e,g(e(x)("Cities")),1)]),_:1}),t(K,{class:"d-flex align-center flex-wrap gap-2 py-4"},{default:l(()=>[_("div",Le,[t(ue,{modelValue:e(i),"onUpdate:modelValue":n[0]||(n[0]=v=>R(i)?i.value=v:null),variant:"outlined",items:[5,10,20,30,50]},null,8,["modelValue"])]),Z((y(),D($,{"prepend-icon":"tabler-plus",onClick:n[1]||(n[1]=v=>k.value=!0)},{default:l(()=>[F(g(e(x)("Add_City")),1)]),_:1})),[[j,"create-city"]]),t(we)]),_:1}),t(me),t(ke,{class:"text-no-wrap product-list-table"},{default:l(()=>[_("thead",null,[_("tr",null,[_("th",Ue,g(e(x)("forms.id")),1),_("th",Fe,g(e(x)("forms.name")),1),_("th",Ee,g(e(x)("forms.country")),1),_("th",ze,g(e(x)("forms.is_active")),1),_("th",Be,g(e(x)("forms.actions")),1)])]),_("tbody",null,[(y(!0),P(oe,null,se(e(U),(v,he)=>(y(),P("tr",{key:v.id},[_("td",null," #"+g(++he),1),_("td",null,g(v.name_ar),1),_("td",null,g(v.country?v.country.name_ar:"\u0644\u0627 \u064A\u0648\u062C\u062F"),1),_("td",{onClick:de=>q(v)},[t(L,{icon:"ph:dot-bold",color:v.is_active==!0?"#008000":"#f00000",size:"32"},null,8,["color"]),_("span",null,g(v.is_active==!0?e(x)("forms.statuses.active"):e(x)("forms.statuses.inactive")),1)],8,Ie),Z((y(),P("td",null,[Z((y(),D($,{icon:"",variant:"plain",color:"default",size:"x-small",onClick:de=>c(v)},{default:l(()=>[t(L,{size:22,icon:"tabler-pencil"})]),_:2},1032,["onClick"])),[[j,"update-city"]]),Z((y(),D($,{icon:"",variant:"plain",color:"default",size:"x-small",onClick:de=>N(v)},{default:l(()=>[t(L,{size:22,icon:"tabler-trash"})]),_:2},1032,["onClick"])),[[j,"delete-city"]])])),[[j,"create-city"]])]))),128))]),Z(_("tfoot",null,qe,512),[[Se,!e(V).length]])]),_:1}),t(me),t(K,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3"},{default:l(()=>[_("span",Ne,g(e(B)),1),t(xe,{modelValue:e(h),"onUpdate:modelValue":n[2]||(n[2]=v=>R(h)?h.value=v:null),size:"small","total-visible":e(i),length:e(C),onNext:A,onPrev:z},null,8,["modelValue","total-visible","length"])]),_:1})]),_:1},8,["loading"]),t(d,{isAddOpen:e(k),"onUpdate:isAddOpen":n[3]||(n[3]=v=>R(k)?k.value=v:null),onRefreshTable:u},null,8,["isAddOpen"]),t(f,{isEditOpen:e(m),"onUpdate:isEditOpen":n[4]||(n[4]=v=>R(m)?m.value=v:null),city:e(p),onRefreshTable:u},null,8,["isEditOpen","city"]),t(I,{isDeleteOpen:e(r),"onUpdate:isDeleteOpen":n[5]||(n[5]=v=>R(r)?r.value=v:null),city:e(p),onRefreshTable:u},null,8,["isDeleteOpen","city"])])}}};export{pt as default};
