import{aB as N,bP as $,k as n,bD as j,c6 as E,r as Q,o as k,b as A,w as s,p as l,bQ as G,bR as H,bS as J,ak as T,m as K,y as S,q as e,b$ as W,c0 as X,av as Y,aw as d,al as x,ap as z}from"./index.8696608c.js";import{_ as Z}from"./DialogCloseBtn.fa23c62a.js";import{u as ee}from"./Products.c153737a.js";import{r as P}from"./validators.dc210ddc.js";import{V as ae}from"./VForm.b24f32c4.js";import{V as p}from"./VSelect.8b1bd621.js";import{a as le}from"./VList.2c4b0ac9.js";import{d as I}from"./VTextField.5650c267.js";import{V as te}from"./VDivider.f9f5c85d.js";import{V as b}from"./VCheckbox.1f81e87c.js";import{V as se}from"./VDialog.7b711207.js";import"./forwardRefs.74a345f5.js";import"./VOverlay.b159883d.js";import"./lazy.e80e0acb.js";import"./VMenu.6210b3de.js";import"./VCheckboxBtn.61f55216.js";import"./VChip.e8cfcd99.js";import"./index.461d6288.js";import"./ssrBoot.1b100f40.js";const oe={class:"mx-1 my-1"},Se={__name:"AddNewProduct",props:{isAddOpen:{type:Boolean,required:!0},order:{type:Object,required:!0},sizes:{type:Array,required:!0},micedmeats:{type:Array,required:!0},cuts:{type:Array,required:!0},preparations:{type:Array,required:!0}},emits:["update:isAddOpen","refreshTable"],setup(L,{emit:O}){const c=L,_=O,g=ee(),r=N(),{t:i}=$(),C=n(null),y=n([]),w=n([]),V=n(!1),a=j({order_id:null,product_id:null,quantity:null,cut_ids:[],size_ids:[],miced_meat_ids:[],preparation_ids:[],shalwata:0,is_karashah:0,is_kwar3:0,is_lyh:0,is_Ras:null}),B=u=>{if(!u){y.value=[],w.value=[];return}V.value=!0,g.fetchProduct(u).then(t=>{y.value=t.data.data.sizes,w.value=t.data.data.MicedMeats}).finally(()=>{V.value=!1})};E(()=>{a.order_id=c.order?c.order.id:0});const M=n([]),v=n(!1),D=()=>{a.order_id=null,a.product_id=null,a.quantity=null,a.cut_ids=null,a.size_ids=null,a.miced_meat_ids=null,a.preparation_ids=null,a.shalwata=0,a.is_karashah=0,a.is_kwar3=0,a.is_lyh=0,a.is_Ras=null,_("update:isAddOpen",!1)},F=async()=>{(await C.value.validate()).valid?(v.value=!0,g.addNewProduct(a).then(t=>{_("refreshTable"),_("update:isAddOpen",!1),r.alertColor="success",r.alertMessage="\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0646\u062A\u062C \u0628\u0646\u062C\u0627\u062D",r.isAlertShow=!0,setTimeout(()=>{r.isAlertShow=!1,r.alertMessage=""},2e3)}).catch(t=>{t.response.data.errors?Object.keys(t.response.data.errors).forEach(m=>{r.alertMessage=i(`errors.${m}`)}):r.alertMessage="\u062D\u062F\u062B \u062E\u0637\u0623 \u0645\u0627 !",r.alertColor="error",r.isAlertShow=!0,setTimeout(()=>{r.isAlertShow=!1,r.alertMessage=""},2e3)}).finally(()=>{v.value=!1})):(v.value=!1,r.alertMessage="\u064A\u0631\u062C\u064A \u062A\u0639\u0628\u0626\u0629 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629 !",r.alertColor="error",r.isAlertShow=!0,setTimeout(()=>{r.isAlertShow=!1,r.alertMessage=""},2e3))},U=u=>{_("update:isAddOpen",u)},q=n(null),h=n(!1),R=u=>{clearTimeout(q.value),q.value=setTimeout(()=>{h.value=!0,g.fetchProducts({search:u.target.value}).then(t=>{var f,m;M.value=((m=(f=t.data)==null?void 0:f.data)==null?void 0:m.data)||[]}).finally(()=>{h.value=!1})},800)};return(u,t)=>{const f=Z,m=Q("VListItemContent");return k(),A(se,{width:u.$vuetify.display.smAndDown?"auto":650,"model-value":c.isAddOpen,"onUpdate:modelValue":U},{default:s(()=>[l(f,{onClick:t[0]||(t[0]=o=>U(!1))}),l(G,{class:"pa-sm-9 pa-5"},{default:s(()=>[l(H,null,{default:s(()=>[l(J,{class:"text-h5 d-flex flex-column align-center gap-2 text-center mb-3"},{default:s(()=>[l(T,{icon:"streamline:shopping-bag-hand-bag-1-shopping-bag-purse-goods-item-products",size:"24",color:"primary"}),K("span",oe,S(e(i)("Add_Item")),1)]),_:1})]),_:1}),l(W,null,{default:s(()=>[l(ae,{ref_key:"refForm",ref:C,onSubmit:X(F,["prevent"])},{default:s(()=>[l(Y,null,{default:s(()=>[l(d,{cols:"12",md:"6"},{default:s(()=>[l(p,{modelValue:e(a).product_id,"onUpdate:modelValue":[t[1]||(t[1]=o=>e(a).product_id=o),B],items:e(M),label:e(i)("forms.products"),"item-title":"name_ar","item-value":"id",clearable:"",rules:[e(P)],loading:e(h)},{"prepend-item":s(()=>[l(le,null,{default:s(()=>[l(m,null,{default:s(()=>[l(I,{placeholder:"\u0627\u0644\u0628\u062D\u062B \u0641\u064A \u0627\u0644\u0645\u0646\u062A\u062C\u0627\u062A",onInput:R})]),_:1})]),_:1}),l(te,{class:"mt-2"})]),_:1},8,["modelValue","items","label","rules","loading"])]),_:1}),l(d,{cols:"12",md:"6"},{default:s(()=>[l(I,{modelValue:e(a).quantity,"onUpdate:modelValue":t[2]||(t[2]=o=>e(a).quantity=o),label:e(i)("forms.quantity")},null,8,["modelValue","label"])]),_:1}),l(d,{cols:"12",md:"6"},{default:s(()=>[l(p,{modelValue:e(a).cut_ids,"onUpdate:modelValue":t[3]||(t[3]=o=>e(a).cut_ids=o),items:c.cuts,label:e(i)("forms.product_cut"),"item-title":"name_ar","item-value":"id"},null,8,["modelValue","items","label"])]),_:1}),l(d,{cols:"12",md:"6"},{default:s(()=>[l(p,{modelValue:e(a).size_ids,"onUpdate:modelValue":t[4]||(t[4]=o=>e(a).size_ids=o),items:e(y),label:e(i)("forms.product_size"),"item-title":"name_ar","item-value":"id",rules:[e(P)],loading:e(V)},null,8,["modelValue","items","label","rules","loading"])]),_:1}),l(d,{cols:"12",md:"6"},{default:s(()=>[l(p,{modelValue:e(a).miced_meat_ids,"onUpdate:modelValue":t[5]||(t[5]=o=>e(a).miced_meat_ids=o),items:e(w),label:e(i)("forms.productMicedMeats"),"item-title":"name_ar","item-value":"id",loading:e(V)},null,8,["modelValue","items","label","loading"])]),_:1}),l(d,{cols:"12",md:"6"},{default:s(()=>[l(p,{modelValue:e(a).preparation_ids,"onUpdate:modelValue":t[6]||(t[6]=o=>e(a).preparation_ids=o),items:c.preparations,label:e(i)("forms.product_preparation"),"item-title":"name_ar","item-value":"id"},null,8,["modelValue","items","label"])]),_:1}),l(d,{cols:"12",md:"6"},{default:s(()=>[l(p,{modelValue:e(a).is_Ras,"onUpdate:modelValue":t[7]||(t[7]=o=>e(a).is_Ras=o),items:[{name_ar:"\u0633\u0644\u062E",id:"salkh"},{name_ar:"\u0628\u062F\u0648\u0646",id:"without"},{name_ar:"\u0634\u0644\u0648\u0637\u0629",id:"shalwta"}],label:e(i)("forms.ra2s"),"item-title":"name_ar","item-value":"id"},null,8,["modelValue","label"])]),_:1}),l(d,{cols:"12",md:"6"},{default:s(()=>[l(b,{modelValue:e(a).shalwata,"onUpdate:modelValue":t[8]||(t[8]=o=>e(a).shalwata=o),label:"\u0645\u0639 \u0634\u0644\u0648\u0637\u0629","false-value":0,"true-value":1},null,8,["modelValue"])]),_:1}),l(d,{cols:"12",md:"6",class:"d-flex gap-9"},{default:s(()=>[l(b,{modelValue:e(a).is_karashah,"onUpdate:modelValue":t[9]||(t[9]=o=>e(a).is_karashah=o),label:"\u0628\u062F\u0648\u0646 \u0643\u0631\u0634\u0629","false-value":0,"true-value":1},null,8,["modelValue"]),l(b,{modelValue:e(a).is_kwar3,"onUpdate:modelValue":t[10]||(t[10]=o=>e(a).is_kwar3=o),label:"\u0628\u062F\u0648\u0646 \u0643\u0648\u0627\u0631\u0639","false-value":0,"true-value":1},null,8,["modelValue"])]),_:1}),l(d,{cols:"12",md:"6",class:"d-flex gap-10"},{default:s(()=>[l(b,{modelValue:e(a).is_lyh,"onUpdate:modelValue":t[11]||(t[11]=o=>e(a).is_lyh=o),label:"\u0628\u062F\u0648\u0646 \u0644\u064A\u0647","false-value":0,"true-value":1},null,8,["modelValue"])]),_:1}),l(d,{cols:"12",class:"text-center mt-8"},{default:s(()=>[e(v)?(k(),A(x,{key:1,type:"submit",class:"position-relative me-3 px-8"},{default:s(()=>[l(T,{icon:"mingcute:loading-line",class:"loading",size:"32"})]),_:1})):(k(),A(x,{key:0,type:"submit",class:"me-3 px-8"},{default:s(()=>[z(S(e(i)("buttons.save")),1)]),_:1})),l(x,{variant:"tonal",color:"secondary",class:"px-8",onClick:D},{default:s(()=>[z(S(e(i)("buttons.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}};export{Se as default};
